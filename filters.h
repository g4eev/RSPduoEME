// RSPduoEME Copyright 2020 David Warwick G4EEV
//
// This file is part of RSPduoEME.
//
// RSPduoEME is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License
// as published by the Free Software Foundation, either version 3 of the License, or(at your option) any later version.
// RSPduoEME is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details. You should have
// received a copy of the GNU General Public License along with RSPduoEMRE, if not, see <https://www.gnu.org/licenses/>.



#ifndef FILTERS_H
#define FILTERS_H

// Decimate by 2 filter (D2A) Passband 200KHz, Stopband 500-1000KHz -56dB

// Matlab / Octave code below:


// % Decimation by 2 polyphase filter for RSPapiWidget
//
// % Passband 0-200KHz, Stopband 500-1000KHz attenuation -56dB
//
// pkg load signal  % required for Octave for renez
//
// F1=200000;
// F2=500000;
// Fs2=1000000;  % Fs/2
// Order=17; % Output is Order+1 taps (output needs to be multiple of 2!)
//
// F=[0,F1/Fs2,F2/Fs2,1]
// M=[1,1,0,0]
// W=[10,40] % Weight between passband and stopband ripple
//
// B=remez(Order,F,M,W);
// [h,w] = freqz(B,1,256);
// plot(Fs2*w/pi,20*log10(abs(h)))
// grid on;
// zoom on;
//
// i=linspace(0,Order,Order+1);
//
// fprintf('/* D2ACoef[%i] */       %1.10f ,\n',[i;B']);


#define D2A_Order 18             // for polyphase filter must be a multiple of 2

double (*I_D2AA)[D2A_Order/2];    // pointer to polyphase filter arrays channel A
double (*Q_D2AA)[D2A_Order/2];
double (*I_D2AB)[D2A_Order/2];    // pointer to polyphase filter arrays channel B
double (*Q_D2AB)[D2A_Order/2];

double D2ACoef[18] {

    /* D2ACoef[0] */       0.0035056984 ,
    /* D2ACoef[1] */       0.0110740018 ,
    /* D2ACoef[2] */       0.0088869478 ,
    /* D2ACoef[3] */       -0.0141825011 ,
    /* D2ACoef[4] */       -0.0453423662 ,
    /* D2ACoef[5] */       -0.0362117340 ,
    /* D2ACoef[6] */       0.0538900217 ,
    /* D2ACoef[7] */       0.2023614691 ,
    /* D2ACoef[8] */       0.3189759768 ,
    /* D2ACoef[9] */       0.3189759768 ,
    /* D2ACoef[10] */       0.2023614691 ,
    /* D2ACoef[11] */       0.0538900217 ,
    /* D2ACoef[12] */       -0.0362117340 ,
    /* D2ACoef[13] */       -0.0453423662 ,
    /* D2ACoef[14] */       -0.0141825011 ,
    /* D2ACoef[15] */       0.0088869478 ,
    /* D2ACoef[16] */       0.0110740018 ,
    /* D2ACoef[17] */       0.0035056984 ,

};


// Decimate by 2 filter (D2B) Passband 100KHz, Stopband 250-500KHz -56dB

// Matlab / Octave code below:


// % Decimation by 2 polyphase filter for RSPapiWidget
//
// % Passband 0-100KHz, Stopband 250-500KHz attenuation -56dB
//
// pkg load signal  % required for Octave for renez
//
// F1=100000;
// F2=250000;
// Fs2=500000;  % Fs/2
// Order=17; % Output is Order+1 taps (output needs to be multiple of 2!)
//
// F=[0,F1/Fs2,F2/Fs2,1]
// M=[1,1,0,0]
// W=[10,40] % Weight between passband and stopband ripple
//
// B=remez(Order,F,M,W);
// [h,w] = freqz(B,1,256);
// plot(Fs2*w/pi,20*log10(abs(h)))
// grid on;
// zoom on;
//
// i=linspace(0,Order,Order+1);
//
// fprintf('/* D2BCoef[%i] */       %1.10f ,\n',[i;B']);


#define D2B_Order 18             // for polyphase filter must be a multiple of 2

double (*I_D2BA)[D2B_Order/2];    // pointer to polyphase filter arrays Ch A
double (*Q_D2BA)[D2B_Order/2];
double (*I_D2BB)[D2B_Order/2];    // pointer to polyphase filter arrays Ch B
double (*Q_D2BB)[D2B_Order/2];

double D2BCoef[18] {

    /* D2BCoef[0] */       0.0035056984 ,
    /* D2BCoef[1] */       0.0110740018 ,
    /* D2BCoef[2] */       0.0088869478 ,
    /* D2BCoef[3] */       -0.0141825011 ,
    /* D2BCoef[4] */       -0.0453423662 ,
    /* D2BCoef[5] */       -0.0362117340 ,
    /* D2BCoef[6] */       0.0538900217 ,
    /* D2BCoef[7] */       0.2023614691 ,
    /* D2BCoef[8] */       0.3189759768 ,
    /* D2BCoef[9] */       0.3189759768 ,
    /* D2BCoef[10] */       0.2023614691 ,
    /* D2BCoef[11] */       0.0538900217 ,
    /* D2BCoef[12] */       -0.0362117340 ,
    /* D2BCoef[13] */       -0.0453423662 ,
    /* D2BCoef[14] */       -0.0141825011 ,
    /* D2BCoef[15] */       0.0088869478 ,
    /* D2BCoef[16] */       0.0110740018 ,
    /* D2BCoef[17] */       0.0035056984 ,

};



// Decimate by 5 filter (DF5) Bandwith 1/5, stopband -45dB

// Matlab / Octave code below:


// % Decimation by 5 polyphase filter for RSPduoStream
//
// % Stopband -45dB
//
// pkg load signal  % required for Octave for renez
//
// F1=18500;
// F2=20500;
// Fs2=100000;  % Fs/2
// Order=219; % Output is Order+1 taps (output needs to be multiple of 5!)
//
// F=[0,F1/Fs2,F2/Fs2,1]
// M=[1,1,0,0]
// W=[20,40] % Weight between passband and stopband ripple
//
// B=remez(Order,F,M,W);
// [h,w] = freqz(B,1,256);
// plot(Fs2*w/pi,20*log10(abs(h)))
// grid on;
// zoom on;
//
// i=linspace(0,Order,Order+1);
//
// fprintf('/* D5Coef[%i] */       %1.10f ,\n',[i;B']);


#define D5_Order 220           // for polyphase filter must be a multiple of 5

double (*I_D5A)[D5_Order/5];    // pointer to polyphase filter arrays Ch A
double (*Q_D5A)[D5_Order/5];
double (*I_D5B)[D5_Order/5];    // pointer to polyphase filter arrays Ch B
double (*Q_D5B)[D5_Order/5];

double D5Coef[220] {

    /* D5Coef[0] */       -0.0016951303 ,
    /* D5Coef[1] */       0.0013122481 ,
    /* D5Coef[2] */       0.0013569675 ,
    /* D5Coef[3] */       0.0014613386 ,
    /* D5Coef[4] */       0.0014285793 ,
    /* D5Coef[5] */       0.0011564210 ,
    /* D5Coef[6] */       0.0006567247 ,
    /* D5Coef[7] */       0.0000419783 ,
    /* D5Coef[8] */       -0.0005112762 ,
    /* D5Coef[9] */       -0.0008298701 ,
    /* D5Coef[10] */       -0.0008057501 ,
    /* D5Coef[11] */       -0.0004464040 ,
    /* D5Coef[12] */       0.0001232331 ,
    /* D5Coef[13] */       0.0006930182 ,
    /* D5Coef[14] */       0.0010444206 ,
    /* D5Coef[15] */       0.0010251670 ,
    /* D5Coef[16] */       0.0006167845 ,
    /* D5Coef[17] */       -0.0000570393 ,
    /* D5Coef[18] */       -0.0007586874 ,
    /* D5Coef[19] */       -0.0012289737 ,
    /* D5Coef[20] */       -0.0012681520 ,
    /* D5Coef[21] */       -0.0008365184 ,
    /* D5Coef[22] */       -0.0000534776 ,
    /* D5Coef[23] */       0.0008081059 ,
    /* D5Coef[24] */       0.0014240039 ,
    /* D5Coef[25] */       0.0015529344 ,
    /* D5Coef[26] */       0.0011073963 ,
    /* D5Coef[27] */       0.0002149690 ,
    /* D5Coef[28] */       -0.0008225832 ,
    /* D5Coef[29] */       -0.0016238787 ,
    /* D5Coef[30] */       -0.0018728416 ,
    /* D5Coef[31] */       -0.0014364269 ,
    /* D5Coef[32] */       -0.0004321491 ,
    /* D5Coef[33] */       0.0008032585 ,
    /* D5Coef[34] */       0.0018214110 ,
    /* D5Coef[35] */       0.0022267641 ,
    /* D5Coef[36] */       0.0018252636 ,
    /* D5Coef[37] */       0.0007141271 ,
    /* D5Coef[38] */       -0.0007385316 ,
    /* D5Coef[39] */       -0.0020105695 ,
    /* D5Coef[40] */       -0.0026147969 ,
    /* D5Coef[41] */       -0.0022803904 ,
    /* D5Coef[42] */       -0.0010712549 ,
    /* D5Coef[43] */       0.0006166939 ,
    /* D5Coef[44] */       0.0021849306 ,
    /* D5Coef[45] */       0.0030360687 ,
    /* D5Coef[46] */       0.0028073170 ,
    /* D5Coef[47] */       0.0015148208 ,
    /* D5Coef[48] */       -0.0004271089 ,
    /* D5Coef[49] */       -0.0023342409 ,
    /* D5Coef[50] */       -0.0034909907 ,
    /* D5Coef[51] */       -0.0034166022 ,
    /* D5Coef[52] */       -0.0020601751 ,
    /* D5Coef[53] */       0.0001534979 ,
    /* D5Coef[54] */       0.0024516988 ,
    /* D5Coef[55] */       0.0039809149 ,
    /* D5Coef[56] */       0.0041198652 ,
    /* D5Coef[57] */       0.0027271845 ,
    /* D5Coef[58] */       0.0002243737 ,
    /* D5Coef[59] */       -0.0025245604 ,
    /* D5Coef[60] */       -0.0045081994 ,
    /* D5Coef[61] */       -0.0049346108 ,
    /* D5Coef[62] */       -0.0035428207 ,
    /* D5Coef[63] */       -0.0007324658 ,
    /* D5Coef[64] */       0.0025385732 ,
    /* D5Coef[65] */       0.0050785070 ,
    /* D5Coef[66] */       0.0058874219 ,
    /* D5Coef[67] */       0.0045452037 ,
    /* D5Coef[68] */       0.0014078730 ,
    /* D5Coef[69] */       -0.0024747989 ,
    /* D5Coef[70] */       -0.0057014642 ,
    /* D5Coef[71] */       -0.0070178500 ,
    /* D5Coef[72] */       -0.0057943044 ,
    /* D5Coef[73] */       -0.0023059835 ,
    /* D5Coef[74] */       0.0023059791 ,
    /* D5Coef[75] */       0.0063962275 ,
    /* D5Coef[76] */       0.0083917312 ,
    /* D5Coef[77] */       0.0073828570 ,
    /* D5Coef[78] */       0.0035131649 ,
    /* D5Coef[79] */       -0.0019928949 ,
    /* D5Coef[80] */       -0.0072002336 ,
    /* D5Coef[81] */       -0.0101270141 ,
    /* D5Coef[82] */       -0.0094779159 ,
    /* D5Coef[83] */       -0.0051845389 ,
    /* D5Coef[84] */       0.0014643449 ,
    /* D5Coef[85] */       0.0081813962 ,
    /* D5Coef[86] */       0.0124397867 ,
    /* D5Coef[87] */       0.0123903457 ,
    /* D5Coef[88] */       0.0076112836 ,
    /* D5Coef[89] */       -0.0005910808 ,
    /* D5Coef[90] */       -0.0094901343 ,
    /* D5Coef[91] */       -0.0157940137 ,
    /* D5Coef[92] */       -0.0167982938 ,
    /* D5Coef[93] */       -0.0114493315 ,
    /* D5Coef[94] */       -0.0009321984 ,
    /* D5Coef[95] */       0.0114790322 ,
    /* D5Coef[96] */       0.0213353938 ,
    /* D5Coef[97] */       0.0244581855 ,
    /* D5Coef[98] */       0.0184802557 ,
    /* D5Coef[99] */       0.0039722428 ,
    /* D5Coef[100] */       -0.0152652413 ,
    /* D5Coef[101] */       -0.0329290316 ,
    /* D5Coef[102] */       -0.0418309023 ,
    /* D5Coef[103] */       -0.0359829091 ,
    /* D5Coef[104] */       -0.0125471759 ,
    /* D5Coef[105] */       0.0269512683 ,
    /* D5Coef[106] */       0.0765669101 ,
    /* D5Coef[107] */       0.1271192343 ,
    /* D5Coef[108] */       0.1683521256 ,
    /* D5Coef[109] */       0.1914901580 ,
    /* D5Coef[110] */       0.1914901580 ,
    /* D5Coef[111] */       0.1683521256 ,
    /* D5Coef[112] */       0.1271192343 ,
    /* D5Coef[113] */       0.0765669101 ,
    /* D5Coef[114] */       0.0269512683 ,
    /* D5Coef[115] */       -0.0125471759 ,
    /* D5Coef[116] */       -0.0359829091 ,
    /* D5Coef[117] */       -0.0418309023 ,
    /* D5Coef[118] */       -0.0329290316 ,
    /* D5Coef[119] */       -0.0152652413 ,
    /* D5Coef[120] */       0.0039722428 ,
    /* D5Coef[121] */       0.0184802557 ,
    /* D5Coef[122] */       0.0244581855 ,
    /* D5Coef[123] */       0.0213353938 ,
    /* D5Coef[124] */       0.0114790322 ,
    /* D5Coef[125] */       -0.0009321984 ,
    /* D5Coef[126] */       -0.0114493315 ,
    /* D5Coef[127] */       -0.0167982938 ,
    /* D5Coef[128] */       -0.0157940137 ,
    /* D5Coef[129] */       -0.0094901343 ,
    /* D5Coef[130] */       -0.0005910808 ,
    /* D5Coef[131] */       0.0076112836 ,
    /* D5Coef[132] */       0.0123903457 ,
    /* D5Coef[133] */       0.0124397867 ,
    /* D5Coef[134] */       0.0081813962 ,
    /* D5Coef[135] */       0.0014643449 ,
    /* D5Coef[136] */       -0.0051845389 ,
    /* D5Coef[137] */       -0.0094779159 ,
    /* D5Coef[138] */       -0.0101270141 ,
    /* D5Coef[139] */       -0.0072002336 ,
    /* D5Coef[140] */       -0.0019928949 ,
    /* D5Coef[141] */       0.0035131649 ,
    /* D5Coef[142] */       0.0073828570 ,
    /* D5Coef[143] */       0.0083917312 ,
    /* D5Coef[144] */       0.0063962275 ,
    /* D5Coef[145] */       0.0023059791 ,
    /* D5Coef[146] */       -0.0023059835 ,
    /* D5Coef[147] */       -0.0057943044 ,
    /* D5Coef[148] */       -0.0070178500 ,
    /* D5Coef[149] */       -0.0057014642 ,
    /* D5Coef[150] */       -0.0024747989 ,
    /* D5Coef[151] */       0.0014078730 ,
    /* D5Coef[152] */       0.0045452037 ,
    /* D5Coef[153] */       0.0058874219 ,
    /* D5Coef[154] */       0.0050785070 ,
    /* D5Coef[155] */       0.0025385732 ,
    /* D5Coef[156] */       -0.0007324658 ,
    /* D5Coef[157] */       -0.0035428207 ,
    /* D5Coef[158] */       -0.0049346108 ,
    /* D5Coef[159] */       -0.0045081994 ,
    /* D5Coef[160] */       -0.0025245604 ,
    /* D5Coef[161] */       0.0002243737 ,
    /* D5Coef[162] */       0.0027271845 ,
    /* D5Coef[163] */       0.0041198652 ,
    /* D5Coef[164] */       0.0039809149 ,
    /* D5Coef[165] */       0.0024516988 ,
    /* D5Coef[166] */       0.0001534979 ,
    /* D5Coef[167] */       -0.0020601751 ,
    /* D5Coef[168] */       -0.0034166022 ,
    /* D5Coef[169] */       -0.0034909907 ,
    /* D5Coef[170] */       -0.0023342409 ,
    /* D5Coef[171] */       -0.0004271089 ,
    /* D5Coef[172] */       0.0015148208 ,
    /* D5Coef[173] */       0.0028073170 ,
    /* D5Coef[174] */       0.0030360687 ,
    /* D5Coef[175] */       0.0021849306 ,
    /* D5Coef[176] */       0.0006166939 ,
    /* D5Coef[177] */       -0.0010712549 ,
    /* D5Coef[178] */       -0.0022803904 ,
    /* D5Coef[179] */       -0.0026147969 ,
    /* D5Coef[180] */       -0.0020105695 ,
    /* D5Coef[181] */       -0.0007385316 ,
    /* D5Coef[182] */       0.0007141271 ,
    /* D5Coef[183] */       0.0018252636 ,
    /* D5Coef[184] */       0.0022267641 ,
    /* D5Coef[185] */       0.0018214110 ,
    /* D5Coef[186] */       0.0008032585 ,
    /* D5Coef[187] */       -0.0004321491 ,
    /* D5Coef[188] */       -0.0014364269 ,
    /* D5Coef[189] */       -0.0018728416 ,
    /* D5Coef[190] */       -0.0016238787 ,
    /* D5Coef[191] */       -0.0008225832 ,
    /* D5Coef[192] */       0.0002149690 ,
    /* D5Coef[193] */       0.0011073963 ,
    /* D5Coef[194] */       0.0015529344 ,
    /* D5Coef[195] */       0.0014240039 ,
    /* D5Coef[196] */       0.0008081059 ,
    /* D5Coef[197] */       -0.0000534776 ,
    /* D5Coef[198] */       -0.0008365184 ,
    /* D5Coef[199] */       -0.0012681520 ,
    /* D5Coef[200] */       -0.0012289737 ,
    /* D5Coef[201] */       -0.0007586874 ,
    /* D5Coef[202] */       -0.0000570393 ,
    /* D5Coef[203] */       0.0006167845 ,
    /* D5Coef[204] */       0.0010251670 ,
    /* D5Coef[205] */       0.0010444206 ,
    /* D5Coef[206] */       0.0006930182 ,
    /* D5Coef[207] */       0.0001232331 ,
    /* D5Coef[208] */       -0.0004464040 ,
    /* D5Coef[209] */       -0.0008057501 ,
    /* D5Coef[210] */       -0.0008298701 ,
    /* D5Coef[211] */       -0.0005112762 ,
    /* D5Coef[212] */       0.0000419783 ,
    /* D5Coef[213] */       0.0006567247 ,
    /* D5Coef[214] */       0.0011564210 ,
    /* D5Coef[215] */       0.0014285793 ,
    /* D5Coef[216] */       0.0014613386 ,
    /* D5Coef[217] */       0.0013569675 ,
    /* D5Coef[218] */       0.0013122481 ,
    /* D5Coef[219] */       -0.0016951303 ,

};


// Upsample by 6 filter (US6) Bandwith 1/6, stopband -45dB

// Matlab / Octave code below:


// % Upsampler by 6 filter for RSPduoStream
//
// % Stopband -45dB
//
// pkg load signal  % required for Octave for renez
//
// F1=15500;
// F2=17500;
// Fs2=100000;  % Fs/2
// Order=215; % Output is Order+1 taps (output needs to be multiple of 6!)
//
// F=[0,F1/Fs2,F2/Fs2,1]
// M=[1,1,0,0]
// W=[20,40] % Weight between passband and stopband ripple
//
// B=remez(Order,F,M,W);
// [h,w] = freqz(B,1,256);
// plot(Fs2*w/pi,20*log10(abs(h)))
// grid on;
// zoom on;
//
// i=linspace(0,Order,Order+1);
//
// fprintf('/* UF6Coef[%i] */       %1.10f ,\n',[i;B']);


#define US6_Order 216       // for polyphase filter must be a multiple of 6

double *I_US6A;              // pointer to Filter arrays Ch A
double *Q_US6A;
double *I_US6B;              // pointer to Filter arrays Ch B
double *Q_US6B;

double US6Coef[216] {

    /* UF6Coef[0] */       -0.0028282031 ,
    /* UF6Coef[1] */       -0.0007784151 ,
    /* UF6Coef[2] */       -0.0006154956 ,
    /* UF6Coef[3] */       -0.0002764657 ,
    /* UF6Coef[4] */       0.0001781055 ,
    /* UF6Coef[5] */       0.0006541024 ,
    /* UF6Coef[6] */       0.0010388928 ,
    /* UF6Coef[7] */       0.0012358493 ,
    /* UF6Coef[8] */       0.0011861890 ,
    /* UF6Coef[9] */       0.0008949626 ,
    /* UF6Coef[10] */       0.0004246316 ,
    /* UF6Coef[11] */       -0.0001109277 ,
    /* UF6Coef[12] */       -0.0005777096 ,
    /* UF6Coef[13] */       -0.0008346125 ,
    /* UF6Coef[14] */       -0.0008132992 ,
    /* UF6Coef[15] */       -0.0004961847 ,
    /* UF6Coef[16] */       0.0000469524 ,
    /* UF6Coef[17] */       0.0006798497 ,
    /* UF6Coef[18] */       0.0012342231 ,
    /* UF6Coef[19] */       0.0015485071 ,
    /* UF6Coef[20] */       0.0015169089 ,
    /* UF6Coef[21] */       0.0011204853 ,
    /* UF6Coef[22] */       0.0004381470 ,
    /* UF6Coef[23] */       -0.0003683460 ,
    /* UF6Coef[24] */       -0.0010909782 ,
    /* UF6Coef[25] */       -0.0015274391 ,
    /* UF6Coef[26] */       -0.0015439736 ,
    /* UF6Coef[27] */       -0.0011067157 ,
    /* UF6Coef[28] */       -0.0003045283 ,
    /* UF6Coef[29] */       0.0006679555 ,
    /* UF6Coef[30] */       0.0015584050 ,
    /* UF6Coef[31] */       0.0021169747 ,
    /* UF6Coef[32] */       0.0021688983 ,
    /* UF6Coef[33] */       0.0016640545 ,
    /* UF6Coef[34] */       0.0007003832 ,
    /* UF6Coef[35] */       -0.0004940686 ,
    /* UF6Coef[36] */       -0.0016120110 ,
    /* UF6Coef[37] */       -0.0023466007 ,
    /* UF6Coef[38] */       -0.0024756265 ,
    /* UF6Coef[39] */       -0.0019247365 ,
    /* UF6Coef[40] */       -0.0007992328 ,
    /* UF6Coef[41] */       0.0006325591 ,
    /* UF6Coef[42] */       0.0020035605 ,
    /* UF6Coef[43] */       0.0029372549 ,
    /* UF6Coef[44] */       0.0031530830 ,
    /* UF6Coef[45] */       0.0025452710 ,
    /* UF6Coef[46] */       0.0012245095 ,
    /* UF6Coef[47] */       -0.0004996177 ,
    /* UF6Coef[48] */       -0.0021873982 ,
    /* UF6Coef[49] */       -0.0033815753 ,
    /* UF6Coef[50] */       -0.0037287148 ,
    /* UF6Coef[51] */       -0.0030810685 ,
    /* UF6Coef[52] */       -0.0015498716 ,
    /* UF6Coef[53] */       0.0005074805 ,
    /* UF6Coef[54] */       0.0025697820 ,
    /* UF6Coef[55] */       0.0040791835 ,
    /* UF6Coef[56] */       0.0045927808 ,
    /* UF6Coef[57] */       0.0039063971 ,
    /* UF6Coef[58] */       0.0021270198 ,
    /* UF6Coef[59] */       -0.0003372700 ,
    /* UF6Coef[60] */       -0.0028658911 ,
    /* UF6Coef[61] */       -0.0047810386 ,
    /* UF6Coef[62] */       -0.0055250015 ,
    /* UF6Coef[63] */       -0.0048189432 ,
    /* UF6Coef[64] */       -0.0027560630 ,
    /* UF6Coef[65] */       0.0001980021 ,
    /* UF6Coef[66] */       0.0033065759 ,
    /* UF6Coef[67] */       0.0057395570 ,
    /* UF6Coef[68] */       0.0067929650 ,
    /* UF6Coef[69] */       0.0060841518 ,
    /* UF6Coef[70] */       0.0036788543 ,
    /* UF6Coef[71] */       0.0001040099 ,
    /* UF6Coef[72] */       -0.0037593946 ,
    /* UF6Coef[73] */       -0.0068886095 ,
    /* UF6Coef[74] */       -0.0083816085 ,
    /* UF6Coef[75] */       -0.0077088148 ,
    /* UF6Coef[76] */       -0.0048826405 ,
    /* UF6Coef[77] */       -0.0004964513 ,
    /* UF6Coef[78] */       0.0043892668 ,
    /* UF6Coef[79] */       0.0084917894 ,
    /* UF6Coef[80] */       0.0106327734 ,
    /* UF6Coef[81] */       0.0100593804 ,
    /* UF6Coef[82] */       0.0066830250 ,
    /* UF6Coef[83] */       0.0011602766 ,
    /* UF6Coef[84] */       -0.0052138844 ,
    /* UF6Coef[85] */       -0.0107919838 ,
    /* UF6Coef[86] */       -0.0139761908 ,
    /* UF6Coef[87] */       -0.0136467085 ,
    /* UF6Coef[88] */       -0.0095053368 ,
    /* UF6Coef[89] */       -0.0022406980 ,
    /* UF6Coef[90] */       0.0065445751 ,
    /* UF6Coef[91] */       0.0146476285 ,
    /* UF6Coef[92] */       0.0197671897 ,
    /* UF6Coef[93] */       0.0200828597 ,
    /* UF6Coef[94] */       0.0147836409 ,
    /* UF6Coef[95] */       0.0044089476 ,
    /* UF6Coef[96] */       -0.0090933451 ,
    /* UF6Coef[97] */       -0.0226329458 ,
    /* UF6Coef[98] */       -0.0325322943 ,
    /* UF6Coef[99] */       -0.0352710059 ,
    /* UF6Coef[100] */       -0.0282664056 ,
    /* UF6Coef[101] */       -0.0105221394 ,
    /* UF6Coef[102] */       0.0170045526 ,
    /* UF6Coef[103] */       0.0514134606 ,
    /* UF6Coef[104] */       0.0882677863 ,
    /* UF6Coef[105] */       0.1223287587 ,
    /* UF6Coef[106] */       0.1484832664 ,
    /* UF6Coef[107] */       0.1626788444 ,
    /* UF6Coef[108] */       0.1626788444 ,
    /* UF6Coef[109] */       0.1484832664 ,
    /* UF6Coef[110] */       0.1223287587 ,
    /* UF6Coef[111] */       0.0882677863 ,
    /* UF6Coef[112] */       0.0514134606 ,
    /* UF6Coef[113] */       0.0170045526 ,
    /* UF6Coef[114] */       -0.0105221394 ,
    /* UF6Coef[115] */       -0.0282664056 ,
    /* UF6Coef[116] */       -0.0352710059 ,
    /* UF6Coef[117] */       -0.0325322943 ,
    /* UF6Coef[118] */       -0.0226329458 ,
    /* UF6Coef[119] */       -0.0090933451 ,
    /* UF6Coef[120] */       0.0044089476 ,
    /* UF6Coef[121] */       0.0147836409 ,
    /* UF6Coef[122] */       0.0200828597 ,
    /* UF6Coef[123] */       0.0197671897 ,
    /* UF6Coef[124] */       0.0146476285 ,
    /* UF6Coef[125] */       0.0065445751 ,
    /* UF6Coef[126] */       -0.0022406980 ,
    /* UF6Coef[127] */       -0.0095053368 ,
    /* UF6Coef[128] */       -0.0136467085 ,
    /* UF6Coef[129] */       -0.0139761908 ,
    /* UF6Coef[130] */       -0.0107919838 ,
    /* UF6Coef[131] */       -0.0052138844 ,
    /* UF6Coef[132] */       0.0011602766 ,
    /* UF6Coef[133] */       0.0066830250 ,
    /* UF6Coef[134] */       0.0100593804 ,
    /* UF6Coef[135] */       0.0106327734 ,
    /* UF6Coef[136] */       0.0084917894 ,
    /* UF6Coef[137] */       0.0043892668 ,
    /* UF6Coef[138] */       -0.0004964513 ,
    /* UF6Coef[139] */       -0.0048826405 ,
    /* UF6Coef[140] */       -0.0077088148 ,
    /* UF6Coef[141] */       -0.0083816085 ,
    /* UF6Coef[142] */       -0.0068886095 ,
    /* UF6Coef[143] */       -0.0037593946 ,
    /* UF6Coef[144] */       0.0001040099 ,
    /* UF6Coef[145] */       0.0036788543 ,
    /* UF6Coef[146] */       0.0060841518 ,
    /* UF6Coef[147] */       0.0067929650 ,
    /* UF6Coef[148] */       0.0057395570 ,
    /* UF6Coef[149] */       0.0033065759 ,
    /* UF6Coef[150] */       0.0001980021 ,
    /* UF6Coef[151] */       -0.0027560630 ,
    /* UF6Coef[152] */       -0.0048189432 ,
    /* UF6Coef[153] */       -0.0055250015 ,
    /* UF6Coef[154] */       -0.0047810386 ,
    /* UF6Coef[155] */       -0.0028658911 ,
    /* UF6Coef[156] */       -0.0003372700 ,
    /* UF6Coef[157] */       0.0021270198 ,
    /* UF6Coef[158] */       0.0039063971 ,
    /* UF6Coef[159] */       0.0045927808 ,
    /* UF6Coef[160] */       0.0040791835 ,
    /* UF6Coef[161] */       0.0025697820 ,
    /* UF6Coef[162] */       0.0005074805 ,
    /* UF6Coef[163] */       -0.0015498716 ,
    /* UF6Coef[164] */       -0.0030810685 ,
    /* UF6Coef[165] */       -0.0037287148 ,
    /* UF6Coef[166] */       -0.0033815753 ,
    /* UF6Coef[167] */       -0.0021873982 ,
    /* UF6Coef[168] */       -0.0004996177 ,
    /* UF6Coef[169] */       0.0012245095 ,
    /* UF6Coef[170] */       0.0025452710 ,
    /* UF6Coef[171] */       0.0031530830 ,
    /* UF6Coef[172] */       0.0029372549 ,
    /* UF6Coef[173] */       0.0020035605 ,
    /* UF6Coef[174] */       0.0006325591 ,
    /* UF6Coef[175] */       -0.0007992328 ,
    /* UF6Coef[176] */       -0.0019247365 ,
    /* UF6Coef[177] */       -0.0024756265 ,
    /* UF6Coef[178] */       -0.0023466007 ,
    /* UF6Coef[179] */       -0.0016120110 ,
    /* UF6Coef[180] */       -0.0004940686 ,
    /* UF6Coef[181] */       0.0007003832 ,
    /* UF6Coef[182] */       0.0016640545 ,
    /* UF6Coef[183] */       0.0021688983 ,
    /* UF6Coef[184] */       0.0021169747 ,
    /* UF6Coef[185] */       0.0015584050 ,
    /* UF6Coef[186] */       0.0006679555 ,
    /* UF6Coef[187] */       -0.0003045283 ,
    /* UF6Coef[188] */       -0.0011067157 ,
    /* UF6Coef[189] */       -0.0015439736 ,
    /* UF6Coef[190] */       -0.0015274391 ,
    /* UF6Coef[191] */       -0.0010909782 ,
    /* UF6Coef[192] */       -0.0003683460 ,
    /* UF6Coef[193] */       0.0004381470 ,
    /* UF6Coef[194] */       0.0011204853 ,
    /* UF6Coef[195] */       0.0015169089 ,
    /* UF6Coef[196] */       0.0015485071 ,
    /* UF6Coef[197] */       0.0012342231 ,
    /* UF6Coef[198] */       0.0006798497 ,
    /* UF6Coef[199] */       0.0000469524 ,
    /* UF6Coef[200] */       -0.0004961847 ,
    /* UF6Coef[201] */       -0.0008132992 ,
    /* UF6Coef[202] */       -0.0008346125 ,
    /* UF6Coef[203] */       -0.0005777096 ,
    /* UF6Coef[204] */       -0.0001109277 ,
    /* UF6Coef[205] */       0.0004246316 ,
    /* UF6Coef[206] */       0.0008949626 ,
    /* UF6Coef[207] */       0.0011861890 ,
    /* UF6Coef[208] */       0.0012358493 ,
    /* UF6Coef[209] */       0.0010388928 ,
    /* UF6Coef[210] */       0.0006541024 ,
    /* UF6Coef[211] */       0.0001781055 ,
    /* UF6Coef[212] */       -0.0002764657 ,
    /* UF6Coef[213] */       -0.0006154956 ,
    /* UF6Coef[214] */       -0.0007784151 ,
    /* UF6Coef[215] */       -0.0028282031 ,

};

// Upsample by 4 filter (US5), bandwith 1/5, stopband -45dB
// This filter is followed by decimation by 5, so bandwith = 1/5th

// Matlab / Octave code below:


// % Upsampler by 4 filter for RSPdupStream
//
// % Stopband -45dB
//
// pkg load signal  % required for Octave for renez
//
// F1=18500;
// F2=20500;
// Fs2=100000;  % Fs/2
// Order=219; % Output is Order+1 taps (output needs to be multiple of 4!)
//
// F=[0,F1/Fs2,F2/Fs2,1]
// M=[1,1,0,0]
// W=[20,40] % Weight between passband and stopband ripple
//
// B=remez(Order,F,M,W);
// [h,w] = freqz(B,1,256);
// plot(Fs2*w/pi,20*log10(abs(h)))
// grid on;
// zoom on;
//
// i=linspace(0,Order,Order+1);
//
// fprintf('/* UF4Coef[%i] */       %1.10f ,\n',[i;B']);


#define US4_Order 220       // for polyphase filter must be a multiple of 4

double *I_US4A;              // pointer to Filter arrays Ch A
double *Q_US4A;
double *I_US4B;              // pointer to Filter arrays Ch B
double *Q_US4B;

double US4Coef[220] {

    /* UF4Coef[0] */       -0.0016951303 ,
    /* UF4Coef[1] */       0.0013122481 ,
    /* UF4Coef[2] */       0.0013569675 ,
    /* UF4Coef[3] */       0.0014613386 ,
    /* UF4Coef[4] */       0.0014285793 ,
    /* UF4Coef[5] */       0.0011564210 ,
    /* UF4Coef[6] */       0.0006567247 ,
    /* UF4Coef[7] */       0.0000419783 ,
    /* UF4Coef[8] */       -0.0005112762 ,
    /* UF4Coef[9] */       -0.0008298701 ,
    /* UF4Coef[10] */       -0.0008057501 ,
    /* UF4Coef[11] */       -0.0004464040 ,
    /* UF4Coef[12] */       0.0001232331 ,
    /* UF4Coef[13] */       0.0006930182 ,
    /* UF4Coef[14] */       0.0010444206 ,
    /* UF4Coef[15] */       0.0010251670 ,
    /* UF4Coef[16] */       0.0006167845 ,
    /* UF4Coef[17] */       -0.0000570393 ,
    /* UF4Coef[18] */       -0.0007586874 ,
    /* UF4Coef[19] */       -0.0012289737 ,
    /* UF4Coef[20] */       -0.0012681520 ,
    /* UF4Coef[21] */       -0.0008365184 ,
    /* UF4Coef[22] */       -0.0000534776 ,
    /* UF4Coef[23] */       0.0008081059 ,
    /* UF4Coef[24] */       0.0014240039 ,
    /* UF4Coef[25] */       0.0015529344 ,
    /* UF4Coef[26] */       0.0011073963 ,
    /* UF4Coef[27] */       0.0002149690 ,
    /* UF4Coef[28] */       -0.0008225832 ,
    /* UF4Coef[29] */       -0.0016238787 ,
    /* UF4Coef[30] */       -0.0018728416 ,
    /* UF4Coef[31] */       -0.0014364269 ,
    /* UF4Coef[32] */       -0.0004321491 ,
    /* UF4Coef[33] */       0.0008032585 ,
    /* UF4Coef[34] */       0.0018214110 ,
    /* UF4Coef[35] */       0.0022267641 ,
    /* UF4Coef[36] */       0.0018252636 ,
    /* UF4Coef[37] */       0.0007141271 ,
    /* UF4Coef[38] */       -0.0007385316 ,
    /* UF4Coef[39] */       -0.0020105695 ,
    /* UF4Coef[40] */       -0.0026147969 ,
    /* UF4Coef[41] */       -0.0022803904 ,
    /* UF4Coef[42] */       -0.0010712549 ,
    /* UF4Coef[43] */       0.0006166939 ,
    /* UF4Coef[44] */       0.0021849306 ,
    /* UF4Coef[45] */       0.0030360687 ,
    /* UF4Coef[46] */       0.0028073170 ,
    /* UF4Coef[47] */       0.0015148208 ,
    /* UF4Coef[48] */       -0.0004271089 ,
    /* UF4Coef[49] */       -0.0023342409 ,
    /* UF4Coef[50] */       -0.0034909907 ,
    /* UF4Coef[51] */       -0.0034166022 ,
    /* UF4Coef[52] */       -0.0020601751 ,
    /* UF4Coef[53] */       0.0001534979 ,
    /* UF4Coef[54] */       0.0024516988 ,
    /* UF4Coef[55] */       0.0039809149 ,
    /* UF4Coef[56] */       0.0041198652 ,
    /* UF4Coef[57] */       0.0027271845 ,
    /* UF4Coef[58] */       0.0002243737 ,
    /* UF4Coef[59] */       -0.0025245604 ,
    /* UF4Coef[60] */       -0.0045081994 ,
    /* UF4Coef[61] */       -0.0049346108 ,
    /* UF4Coef[62] */       -0.0035428207 ,
    /* UF4Coef[63] */       -0.0007324658 ,
    /* UF4Coef[64] */       0.0025385732 ,
    /* UF4Coef[65] */       0.0050785070 ,
    /* UF4Coef[66] */       0.0058874219 ,
    /* UF4Coef[67] */       0.0045452037 ,
    /* UF4Coef[68] */       0.0014078730 ,
    /* UF4Coef[69] */       -0.0024747989 ,
    /* UF4Coef[70] */       -0.0057014642 ,
    /* UF4Coef[71] */       -0.0070178500 ,
    /* UF4Coef[72] */       -0.0057943044 ,
    /* UF4Coef[73] */       -0.0023059835 ,
    /* UF4Coef[74] */       0.0023059791 ,
    /* UF4Coef[75] */       0.0063962275 ,
    /* UF4Coef[76] */       0.0083917312 ,
    /* UF4Coef[77] */       0.0073828570 ,
    /* UF4Coef[78] */       0.0035131649 ,
    /* UF4Coef[79] */       -0.0019928949 ,
    /* UF4Coef[80] */       -0.0072002336 ,
    /* UF4Coef[81] */       -0.0101270141 ,
    /* UF4Coef[82] */       -0.0094779159 ,
    /* UF4Coef[83] */       -0.0051845389 ,
    /* UF4Coef[84] */       0.0014643449 ,
    /* UF4Coef[85] */       0.0081813962 ,
    /* UF4Coef[86] */       0.0124397867 ,
    /* UF4Coef[87] */       0.0123903457 ,
    /* UF4Coef[88] */       0.0076112836 ,
    /* UF4Coef[89] */       -0.0005910808 ,
    /* UF4Coef[90] */       -0.0094901343 ,
    /* UF4Coef[91] */       -0.0157940137 ,
    /* UF4Coef[92] */       -0.0167982938 ,
    /* UF4Coef[93] */       -0.0114493315 ,
    /* UF4Coef[94] */       -0.0009321984 ,
    /* UF4Coef[95] */       0.0114790322 ,
    /* UF4Coef[96] */       0.0213353938 ,
    /* UF4Coef[97] */       0.0244581855 ,
    /* UF4Coef[98] */       0.0184802557 ,
    /* UF4Coef[99] */       0.0039722428 ,
    /* UF4Coef[100] */       -0.0152652413 ,
    /* UF4Coef[101] */       -0.0329290316 ,
    /* UF4Coef[102] */       -0.0418309023 ,
    /* UF4Coef[103] */       -0.0359829091 ,
    /* UF4Coef[104] */       -0.0125471759 ,
    /* UF4Coef[105] */       0.0269512683 ,
    /* UF4Coef[106] */       0.0765669101 ,
    /* UF4Coef[107] */       0.1271192343 ,
    /* UF4Coef[108] */       0.1683521256 ,
    /* UF4Coef[109] */       0.1914901580 ,
    /* UF4Coef[110] */       0.1914901580 ,
    /* UF4Coef[111] */       0.1683521256 ,
    /* UF4Coef[112] */       0.1271192343 ,
    /* UF4Coef[113] */       0.0765669101 ,
    /* UF4Coef[114] */       0.0269512683 ,
    /* UF4Coef[115] */       -0.0125471759 ,
    /* UF4Coef[116] */       -0.0359829091 ,
    /* UF4Coef[117] */       -0.0418309023 ,
    /* UF4Coef[118] */       -0.0329290316 ,
    /* UF4Coef[119] */       -0.0152652413 ,
    /* UF4Coef[120] */       0.0039722428 ,
    /* UF4Coef[121] */       0.0184802557 ,
    /* UF4Coef[122] */       0.0244581855 ,
    /* UF4Coef[123] */       0.0213353938 ,
    /* UF4Coef[124] */       0.0114790322 ,
    /* UF4Coef[125] */       -0.0009321984 ,
    /* UF4Coef[126] */       -0.0114493315 ,
    /* UF4Coef[127] */       -0.0167982938 ,
    /* UF4Coef[128] */       -0.0157940137 ,
    /* UF4Coef[129] */       -0.0094901343 ,
    /* UF4Coef[130] */       -0.0005910808 ,
    /* UF4Coef[131] */       0.0076112836 ,
    /* UF4Coef[132] */       0.0123903457 ,
    /* UF4Coef[133] */       0.0124397867 ,
    /* UF4Coef[134] */       0.0081813962 ,
    /* UF4Coef[135] */       0.0014643449 ,
    /* UF4Coef[136] */       -0.0051845389 ,
    /* UF4Coef[137] */       -0.0094779159 ,
    /* UF4Coef[138] */       -0.0101270141 ,
    /* UF4Coef[139] */       -0.0072002336 ,
    /* UF4Coef[140] */       -0.0019928949 ,
    /* UF4Coef[141] */       0.0035131649 ,
    /* UF4Coef[142] */       0.0073828570 ,
    /* UF4Coef[143] */       0.0083917312 ,
    /* UF4Coef[144] */       0.0063962275 ,
    /* UF4Coef[145] */       0.0023059791 ,
    /* UF4Coef[146] */       -0.0023059835 ,
    /* UF4Coef[147] */       -0.0057943044 ,
    /* UF4Coef[148] */       -0.0070178500 ,
    /* UF4Coef[149] */       -0.0057014642 ,
    /* UF4Coef[150] */       -0.0024747989 ,
    /* UF4Coef[151] */       0.0014078730 ,
    /* UF4Coef[152] */       0.0045452037 ,
    /* UF4Coef[153] */       0.0058874219 ,
    /* UF4Coef[154] */       0.0050785070 ,
    /* UF4Coef[155] */       0.0025385732 ,
    /* UF4Coef[156] */       -0.0007324658 ,
    /* UF4Coef[157] */       -0.0035428207 ,
    /* UF4Coef[158] */       -0.0049346108 ,
    /* UF4Coef[159] */       -0.0045081994 ,
    /* UF4Coef[160] */       -0.0025245604 ,
    /* UF4Coef[161] */       0.0002243737 ,
    /* UF4Coef[162] */       0.0027271845 ,
    /* UF4Coef[163] */       0.0041198652 ,
    /* UF4Coef[164] */       0.0039809149 ,
    /* UF4Coef[165] */       0.0024516988 ,
    /* UF4Coef[166] */       0.0001534979 ,
    /* UF4Coef[167] */       -0.0020601751 ,
    /* UF4Coef[168] */       -0.0034166022 ,
    /* UF4Coef[169] */       -0.0034909907 ,
    /* UF4Coef[170] */       -0.0023342409 ,
    /* UF4Coef[171] */       -0.0004271089 ,
    /* UF4Coef[172] */       0.0015148208 ,
    /* UF4Coef[173] */       0.0028073170 ,
    /* UF4Coef[174] */       0.0030360687 ,
    /* UF4Coef[175] */       0.0021849306 ,
    /* UF4Coef[176] */       0.0006166939 ,
    /* UF4Coef[177] */       -0.0010712549 ,
    /* UF4Coef[178] */       -0.0022803904 ,
    /* UF4Coef[179] */       -0.0026147969 ,
    /* UF4Coef[180] */       -0.0020105695 ,
    /* UF4Coef[181] */       -0.0007385316 ,
    /* UF4Coef[182] */       0.0007141271 ,
    /* UF4Coef[183] */       0.0018252636 ,
    /* UF4Coef[184] */       0.0022267641 ,
    /* UF4Coef[185] */       0.0018214110 ,
    /* UF4Coef[186] */       0.0008032585 ,
    /* UF4Coef[187] */       -0.0004321491 ,
    /* UF4Coef[188] */       -0.0014364269 ,
    /* UF4Coef[189] */       -0.0018728416 ,
    /* UF4Coef[190] */       -0.0016238787 ,
    /* UF4Coef[191] */       -0.0008225832 ,
    /* UF4Coef[192] */       0.0002149690 ,
    /* UF4Coef[193] */       0.0011073963 ,
    /* UF4Coef[194] */       0.0015529344 ,
    /* UF4Coef[195] */       0.0014240039 ,
    /* UF4Coef[196] */       0.0008081059 ,
    /* UF4Coef[197] */       -0.0000534776 ,
    /* UF4Coef[198] */       -0.0008365184 ,
    /* UF4Coef[199] */       -0.0012681520 ,
    /* UF4Coef[200] */       -0.0012289737 ,
    /* UF4Coef[201] */       -0.0007586874 ,
    /* UF4Coef[202] */       -0.0000570393 ,
    /* UF4Coef[203] */       0.0006167845 ,
    /* UF4Coef[204] */       0.0010251670 ,
    /* UF4Coef[205] */       0.0010444206 ,
    /* UF4Coef[206] */       0.0006930182 ,
    /* UF4Coef[207] */       0.0001232331 ,
    /* UF4Coef[208] */       -0.0004464040 ,
    /* UF4Coef[209] */       -0.0008057501 ,
    /* UF4Coef[210] */       -0.0008298701 ,
    /* UF4Coef[211] */       -0.0005112762 ,
    /* UF4Coef[212] */       0.0000419783 ,
    /* UF4Coef[213] */       0.0006567247 ,
    /* UF4Coef[214] */       0.0011564210 ,
    /* UF4Coef[215] */       0.0014285793 ,
    /* UF4Coef[216] */       0.0014613386 ,
    /* UF4Coef[217] */       0.0013569675 ,
    /* UF4Coef[218] */       0.0013122481 ,
    /* UF4Coef[219] */       -0.0016951303 ,

};

#endif // FILTERS_H
